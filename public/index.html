<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ì „í™”ë²ˆí˜¸ ì¶”ì²¨ ì´ë²¤íŠ¸</title>
<style>
body {
    margin: 0;
    padding: 0;
    font-family: "Pretendard", "Noto Sans KR", sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    background: linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%);
}

.container {
    background: #ffffffdd;
    backdrop-filter: blur(10px);
    padding: 45px 50px;
    border-radius: 20px;
    text-align: center;
    width: 90%;
    max-width: 400px;
    box-shadow: 0px 15px 40px #00000030;
}

h2 {
    margin-bottom: 25px;
    font-size: 1.8rem;
    font-weight: 700;
    color: #333;
}

.number-box {
    font-size: 3.4rem;
    font-weight: 900;
    letter-spacing: 12px;
    margin-bottom: 30px;
    color: #444;
    height: 50px;
    transition: all 0.2s ease-in-out;
}

button {
    background: #7f5af0;
    color: white;
    border: none;
    border-radius: 10px;
    font-size: 1.2rem;
    padding: 15px 25px;
    width: 45%;
    cursor: pointer;
    transition: 0.2s;
    font-weight: 600;
    margin: 5px;
}

button:hover { background: #6245c6; }
button:active { transform: scale(0.98); }

.glow {
    text-shadow: 0 0 8px #7f5af0, 0 0 12px #a18cd1;
}
</style>
</head>
<body>

<div class="container">
    <h2>ì „í™”ë²ˆí˜¸ ë§ˆì§€ë§‰ 4ìë¦¬ ì¶”ì²¨</h2>
    <div id="number" class="number-box">_ _ _ _</div>
    <div>
        <button id="startBtn">â–¶ ì¶”ì²¨ ì‹œì‘</button>
        <button id="resetBtn">ğŸ”„ RESET</button>
    </div>
</div>

<script>
async function getNumber() {
    try {
        const response = await fetch("/api/draw");
        if (!response.ok) throw new Error("ì„œë²„ í˜¸ì¶œ ì‹¤íŒ¨");
        const data = await response.json();
        return data;
    } catch (err) {
        console.error(err);
        return null;
    }
}

document.getElementById("startBtn").addEventListener("click", async () => {
    const numberBox = document.getElementById("number");
    numberBox.innerText = "_ _ _ _";
    numberBox.classList.remove("glow");

    const data = await getNumber();
    if (!data || data.status !== "ok") {
        numberBox.innerText = "ì˜¤ë¥˜ ë°œìƒ";
        return;
    }

    const num = data.number;
    let index = 0;
    let result = "";

    const timer = setInterval(() => {
        result += num[index];
        numberBox.innerText = result.padEnd(4, "_").split("").join(" ");
        numberBox.style.transform = "scale(1.2)";
        numberBox.classList.add("glow");
        setTimeout(() => {
            numberBox.style.transform = "scale(1)";
            numberBox.classList.remove("glow");
        }, 300);

        index++;
        if (index >= 4) clearInterval(timer);
    }, 600);
});

document.getElementById("resetBtn").addEventListener("click", () => {
    const numberBox = document.getElementById("number");
    numberBox.innerText = "_ _ _ _";
